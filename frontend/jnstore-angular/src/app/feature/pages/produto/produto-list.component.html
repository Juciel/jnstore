<div class="card">
  <div class="card-header d-flex justify-content-between align-items-center">
    <h3 class="card-title visually-hidden">Produtos</h3>
    <a class="btn btn-primary" routerLink="/produtos/novo">Adicionar Produto</a>
  </div>
  <div class="card-body">
    <div *ngIf="successMessage" class="alert alert-success">{{ successMessage }}</div>
    <div *ngIf="loading">Carregando...</div>
    <div *ngIf="error" class="alert alert-danger">{{ error }}</div>
    <table *ngIf="!loading && produtos.length" class="table table-striped">
      <thead>
        <tr>
          <th>Nome</th>
          <th>Categoria</th>
          <th>Preço para venda</th>
          <th>Qtd</th>
          <th>Valor da Compra</th>
          <th>Valor de Venda</th>
          <th>Lucro</th>
          <th style="width: 120px;">Ações</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let p of produtos">
          <td>{{ p.nome }}</td>
          <td>{{ p.categoria?.descricao || '-' }}</td>
          <td>{{ p.valorVenda | currency:'BRL':'symbol':'1.2-2' }}</td>
          <td>{{ p.quantidadeTotalEstoque }}</td>
          <td>{{ p.valorTotalCompra | currency:'BRL':'symbol':'1.2-2' }}</td>
          <td>{{ p.valorTotalVenda | currency:'BRL':'symbol':'1.2-2' }}</td>
          <td>{{ p.valorTotalLucro | currency:'BRL':'symbol':'1.2-2' }}</td>
          <td>
            <a [routerLink]="['/produtos', p.id, 'editar']" class="btn btn-sm btn-info me-2"><i class="fas fa-edit"></i></a>
            <button (click)="deleteProduto(p.id, p.nome)" [disabled]="deleting" class="btn btn-sm btn-danger"><i class="fas fa-trash"></i></button>
          </td>
        </tr>
      </tbody>
    </table>
    <div *ngIf="!loading && !produtos.length" class="text-muted">Nenhum produto encontrado.</div>
  </div>
</div>
